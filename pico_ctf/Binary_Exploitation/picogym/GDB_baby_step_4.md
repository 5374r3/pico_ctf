### GDB baby step 4

#Medium #Reverse_Engineering #picoGym #Exclusive #x86_64

Author: LT 'syreal' Jones

#### Description

`main` calls a function that multiplies `eax` by a constant. The flag for this challenge is that constant in decimal base. If the constant you find is 0x1000, the flag will be `picoCTF{4096}`.Debug [this](https://artifacts.picoctf.net/c/532/debugger0_d).

##### Solution:
note: - 
- **“Step Over” (ni)** executes the current line of code and stops at the next one
- **“Step Into” (si)** digs deeper, entering into functions called by the current line of code.

```css
┌─[✔]──[alpha@speed:🍇]──[~/Videos]:
└──╼ $ gdb ./debugger0_d -q
Reading symbols from ./debugger0_d...
(No debugging symbols found in ./debugger0_d)
(gdb) disas main
Dump of assembler code for function main:
   0x000000000040111c <+0>:     endbr64 
   0x0000000000401120 <+4>:     push   %rbp
   0x0000000000401121 <+5>:     mov    %rsp,%rbp
   0x0000000000401124 <+8>:     sub    $0x20,%rsp
   0x0000000000401128 <+12>:    mov    %edi,-0x14(%rbp)
   0x000000000040112b <+15>:    mov    %rsi,-0x20(%rbp)
   0x000000000040112f <+19>:    movl   $0x28e,-0x4(%rbp)
   0x0000000000401136 <+26>:    movl   $0x0,-0x8(%rbp)
   0x000000000040113d <+33>:    mov    -0x4(%rbp),%eax
   0x0000000000401140 <+36>:    mov    %eax,%edi
   0x0000000000401142 <+38>:    call   0x401106 <func1>
   0x0000000000401147 <+43>:    mov    %eax,-0x8(%rbp)
   0x000000000040114a <+46>:    mov    -0x4(%rbp),%eax
   0x000000000040114d <+49>:    leave  
   0x000000000040114e <+50>:    ret    
End of assembler dump.
(gdb) info functions
All defined functions:

Non-debugging symbols:
0x0000000000401000  _init
0x0000000000401020  _start
0x0000000000401050  _dl_relocate_static_pie
0x0000000000401060  deregister_tm_clones
0x0000000000401090  register_tm_clones
0x00000000004010d0  __do_global_dtors_aux
0x0000000000401100  frame_dummy
0x0000000000401106  func1
0x000000000040111c  main
0x0000000000401150  __libc_csu_init
0x00000000004011c0  __libc_csu_fini
0x00000000004011c8  _fini
(gdb) layout asm
```

```css
┌────────────────────────────────────────────────────────────────────────────────────┐
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│b+  0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│    0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
│    0x401169 <__libc_csu_init+25>   mov    %edi,%r12d                               │
│    0x40116c <__libc_csu_init+28>   push   %rbp                                     │
│    0x40116d <__libc_csu_init+29>   lea    0x2ce4(%rip),%rbp        # 0x403e58      │
│    0x401174 <__libc_csu_init+36>   push   %rbx                                     │
│    0x401175 <__libc_csu_init+37>   sub    %r15,%rbp                                │
│    0x401178 <__libc_csu_init+40>   sub    $0x8,%rsp                                │
│    0x40117c <__libc_csu_init+44>   call   0x401000 <_init>                         │
│    0x401181 <__libc_csu_init+49>   sar    $0x3,%rbp                                │
└────────────────────────────────────────────────────────────────────────────────────┘
exec No process In:                                                      L??   PC: ?? 
(gdb) b main
Breakpoint 1 at 0x401124
(gdb) 
```

```css
┌────────────────────────────────────────────────────────────────────────────────────┐
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│b+  0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│b+  0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
│    0x401169 <__libc_csu_init+25>   mov    %edi,%r12d                               │
│    0x40116c <__libc_csu_init+28>   push   %rbp                                     │
│    0x40116d <__libc_csu_init+29>   lea    0x2ce4(%rip),%rbp        # 0x403e58      │
│    0x401174 <__libc_csu_init+36>   push   %rbx                                     │
│    0x401175 <__libc_csu_init+37>   sub    %r15,%rbp                                │
│    0x401178 <__libc_csu_init+40>   sub    $0x8,%rsp                                │
│    0x40117c <__libc_csu_init+44>   call   0x401000 <_init>                         │
│    0x401181 <__libc_csu_init+49>   sar    $0x3,%rbp                                │
└────────────────────────────────────────────────────────────────────────────────────┘
exec No process In:                                                      L??   PC: ?? 
(gdb) b main
Breakpoint 1 at 0x401124
(gdb) b *main+38
Breakpoint 2 at 0x401142
(gdb) 
```

```css
┌────────────────────────────────────────────────────────────────────────────────────┐
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│B+> 0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│b+  0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
│    0x401169 <__libc_csu_init+25>   mov    %edi,%r12d                               │
│    0x40116c <__libc_csu_init+28>   push   %rbp                                     │
│    0x40116d <__libc_csu_init+29>   lea    0x2ce4(%rip),%rbp        # 0x403e58      │
│    0x401174 <__libc_csu_init+36>   push   %rbx                                     │
│    0x401175 <__libc_csu_init+37>   sub    %r15,%rbp                                │
│    0x401178 <__libc_csu_init+40>   sub    $0x8,%rsp                                │
│    0x40117c <__libc_csu_init+44>   call   0x401000 <_init>                         │
│    0x401181 <__libc_csu_init+49>   sar    $0x3,%rbp                                │
└────────────────────────────────────────────────────────────────────────────────────┘
multi-thre Thread 0x7ffff7d7e7 In: main                            L??   PC: 0x401124 
(gdb) b main
Breakpoint 1 at 0x401124
(gdb) b *main+38
Breakpoint 2 at 0x401142
(gdb) r
Starting program: /home/saket/Videos/debugger0_d
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x0000000000401124 in main ()
(gdb)  



```

```css
┌────────────────────────────────────────────────────────────────────────────────────┐
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│B+  0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│B+> 0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
│    0x401169 <__libc_csu_init+25>   mov    %edi,%r12d                               │
│    0x40116c <__libc_csu_init+28>   push   %rbp                                     │
│    0x40116d <__libc_csu_init+29>   lea    0x2ce4(%rip),%rbp        # 0x403e58      │
│    0x401174 <__libc_csu_init+36>   push   %rbx                                     │
│    0x401175 <__libc_csu_init+37>   sub    %r15,%rbp                                │
│    0x401178 <__libc_csu_init+40>   sub    $0x8,%rsp                                │
│    0x40117c <__libc_csu_init+44>   call   0x401000 <_init>                         │
│    0x401181 <__libc_csu_init+49>   sar    $0x3,%rbp                                │
└────────────────────────────────────────────────────────────────────────────────────┘
multi-thre Thread 0x7ffff7d7e7 In: main                            L??   PC: 0x401142 
(gdb) b main
Breakpoint 1 at 0x401124
(gdb) b *main+38
Breakpoint 2 at 0x401142
(gdb) r
Starting program: /home/saket/Videos/debugger0_d
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x0000000000401124 in main ()
(gdb) c
Continuing.

Breakpoint 2, 0x0000000000401142 in main ()
(gdb) 
```

```css
┌────────────────────────────────────────────────────────────────────────────────────┐
│  > 0x401106 <func1>                endbr64                                         │
│    0x40110a <func1+4>              push   %rbp                                     │
│    0x40110b <func1+5>              mov    %rsp,%rbp                                │
│    0x40110e <func1+8>              mov    %edi,-0x4(%rbp)                          │
│    0x401111 <func1+11>             mov    -0x4(%rbp),%eax                          │
│    0x401114 <func1+14>             imul   $0x3269,%eax,%eax                        │
│    0x40111a <func1+20>             pop    %rbp                                     │
│    0x40111b <func1+21>             ret                                             │
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│B+  0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│B+  0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
└────────────────────────────────────────────────────────────────────────────────────┘
multi-thre Thread 0x7ffff7d7e7 In: func1                           L??   PC: 0x401106 
(gdb) b main
Breakpoint 1 at 0x401124
(gdb) b *main+38
Breakpoint 2 at 0x401142
(gdb) r
Starting program: /home/saket/Videos/debugger0_d
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x0000000000401124 in main ()
(gdb) c
Continuing.

Breakpoint 2, 0x0000000000401142 in main ()
(gdb) si
0x0000000000401106 in func1 ()
(gdb) 
```

```CSS
┌────────────────────────────────────────────────────────────────────────────────────┐
│    0x401106 <func1>                endbr64                                         │
│    0x40110a <func1+4>              push   %rbp                                     │
│    0x40110b <func1+5>              mov    %rsp,%rbp                                │
│    0x40110e <func1+8>              mov    %edi,-0x4(%rbp)                          │
│    0x401111 <func1+11>             mov    -0x4(%rbp),%eax                          │
│  > 0x401114 <func1+14>             imul   $0x3269,%eax,%eax                        │
│    0x40111a <func1+20>             pop    %rbp                                     │
│    0x40111b <func1+21>             ret                                             │
│    0x40111c <main>                 endbr64                                         │
│    0x401120 <main+4>               push   %rbp                                     │
│    0x401121 <main+5>               mov    %rsp,%rbp                                │
│B+  0x401124 <main+8>               sub    $0x20,%rsp                               │
│    0x401128 <main+12>              mov    %edi,-0x14(%rbp)                         │
│    0x40112b <main+15>              mov    %rsi,-0x20(%rbp)                         │
│    0x40112f <main+19>              movl   $0x28e,-0x4(%rbp)                        │
│    0x401136 <main+26>              movl   $0x0,-0x8(%rbp)                          │
│    0x40113d <main+33>              mov    -0x4(%rbp),%eax                          │
│    0x401140 <main+36>              mov    %eax,%edi                                │
│B+  0x401142 <main+38>              call   0x401106 <func1>                         │
│    0x401147 <main+43>              mov    %eax,-0x8(%rbp)                          │
│    0x40114a <main+46>              mov    -0x4(%rbp),%eax                          │
│    0x40114d <main+49>              leave                                           │
│    0x40114e <main+50>              ret                                             │
│    0x40114f                        nop                                             │
│    0x401150 <__libc_csu_init>      endbr64                                         │
│    0x401154 <__libc_csu_init+4>    push   %r15                                     │
│    0x401156 <__libc_csu_init+6>    lea    0x2cf3(%rip),%r15        # 0x403e50      │
│    0x40115d <__libc_csu_init+13>   push   %r14                                     │
│    0x40115f <__libc_csu_init+15>   mov    %rdx,%r14                                │
│    0x401162 <__libc_csu_init+18>   push   %r13                                     │
│    0x401164 <__libc_csu_init+20>   mov    %rsi,%r13                                │
│    0x401167 <__libc_csu_init+23>   push   %r12                                     │
└────────────────────────────────────────────────────────────────────────────────────┘
multi-thre Thread 0x7ffff7d7e7 In: func1                           L??   PC: 0x401114 
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Breakpoint 1, 0x0000000000401124 in main ()
(gdb) c
Continuing.

Breakpoint 2, 0x0000000000401142 in main ()
(gdb) si
0x0000000000401106 in func1 ()
(gdb) ni
0x000000000040110a in func1 ()
0x000000000040110b in func1 ()
0x000000000040110e in func1 ()
0x0000000000401111 in func1 ()
0x0000000000401114 in func1 ()
(gdb) print 0x3269
$1 = 12905
(gdb) 
```

note- imul => integer multiplication
flag is `picoCTF{12905}`